version: '1.0'
steps:
  perform_tests:
    image: golang:latest
    working_directory: /go/src/github.com/advance512/prest
    description: Performing unit tests...
    commands:
      - echo Current directory...
      - pwd
      - echo Making directory /go/src/github.com/advance512
      - mkdir -p /go/src/github.com/advance512
      - echo Creating symbolic link...
      - ln -s ${{main_clone}} /go/src/github.com/advance512/prest
      - echo Going to directory /go/src/github.com/advance512/prest
      - pwd
      - cd /
      - pwd
      - cd go
      - pwd
      - cd src
      - pwd
      - cd github.com
      - pwd
      - cd /go/src/github.com/advance512
      - pwd
      - cd prest
      - pwd
      - echo Directory contents...
      - ls -l -a
      - go get
      - go build
      - go test

  build_image:
    type: build
    description: Building the image...
    image_name: advance512/prest
    tag: '${{CF_BRANCH}}'
    
